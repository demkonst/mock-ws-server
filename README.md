# Mock WebSocket Server

–°–µ—Ä–≤–µ—Ä –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ WebSocket –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ HTTP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **WebSocket –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ WebSocket
- **HTTP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —á–µ—Ä–µ–∑ HTTP POST –∑–∞–ø—Ä–æ—Å—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**: –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- **–û—Ç–ª–∞–¥–∫–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ breakpoints –≤ VSCode/Cursor

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mock-ws-server/
‚îú‚îÄ‚îÄ server.js              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ operator.js            # WebSocket –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
‚îú‚îÄ‚îÄ runner.js              # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ transport.js           # HTTP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ transportRunner.js     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º
‚îú‚îÄ‚îÄ operators/             # –§–∞–π–ª—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ operator_01.json
‚îÇ   ‚îú‚îÄ‚îÄ operator_02.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ vehicles/              # –§–∞–π–ª—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ vehicle_01.json
‚îÇ   ‚îú‚îÄ‚îÄ vehicle_02.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ .env.demo              # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è demo
‚îú‚îÄ‚îÄ .env.dev               # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è dev
‚îî‚îÄ‚îÄ .vscode/launch.json    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Ç–ª–∞–¥–∫–∏
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd mock-ws-server
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.demo .env.dev
cp .env.demo .env.stage
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `.env.demo`, `.env.dev`, `.env.stage` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```env
# WebSocket
WS_URL=wss://your-websocket-server.com
AUTH_TOKEN_OPERATOR_01=your-token-1
AUTH_TOKEN_OPERATOR_02=your-token-2
# ... –¥–æ AUTH_TOKEN_OPERATOR_20

# HTTP Transport
TRANSPORT_BASE_URL=https://your-api-server.com/telemetry
```

### –§–∞–π–ª—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `operators/operator_XX.json`:

```json
[
  {
    "type": "message",
    "payload": {
      "timestamp": 1234567890,
      "data": "test"
    },
    "delay": 1000
  }
]
```

### –§–∞–π–ª—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `vehicles/vehicle_XX.json`:

```json
{
  "client": 25071737,
  "moving": true,
  "coords": [
    {
      "lat": 58.07615459,
      "lon": 106.41344925
    }
  ]
}
```

## üöÄ –ó–∞–ø—É—Å–∫

### –û–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
node server.js
```

### –û—Ç–ª–∞–¥–∫–∞ –≤ VSCode/Cursor
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ VSCode/Cursor
2. –ù–∞–∂–º–∏—Ç–µ F5 –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ "Debug mock-ws-server"
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ breakpoints –≤ –∫–æ–¥–µ

## üì° API

### POST /run

–ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `env` (string): –û–∫—Ä—É–∂–µ–Ω–∏–µ (demo, dev, stage)
- `duration` (number): –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST http://localhost:3000/run \
  -H "Content-Type: application/json" \
  -d '{
    "env": "demo",
    "duration": 120
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "operators": [
    {
      "operator": "1",
      "status": "connected",
      "error": null
    }
  ],
  "transport": [
    {
      "client": "1",
      "status": "ready",
      "error": null
    }
  ]
}
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- **`server.js`**: –û—Å–Ω–æ–≤–Ω–æ–π Express —Å–µ—Ä–≤–µ—Ä —Å —Ä–æ—É—Ç–∞–º–∏
- **`operator.js`**: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **`runner.js`**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
- **`transport.js`**: HTTP –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- **`transportRunner.js`**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `operators/operator_XX.json`
2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env.*` —Ñ–∞–π–ª—ã
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `vehicles/vehicle_XX.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TRANSPORT_BASE_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–µ—Ä –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚ùå –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚¨ÖÔ∏è‚û°Ô∏è –í—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚è∞ –ò—Å—Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
- üîÑ –°–±—Ä–æ—Å —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License 